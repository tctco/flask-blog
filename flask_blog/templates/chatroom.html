{% extends 'layout.html' %}
{% block content %}
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.4.8/socket.io.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>

<h2>chatroom</h2>

<script type="text/javascript">
    $(document).ready(function () {


        var socket = io.connect('http://127.0.0.1:5000');
        

        socket.on('connect', function () {
            socket.emit('join', {'room': 'room0'});
            socket.send('you have connected');
        })

        socket.on('message', function (message) {
            var message = JSON.parse(message);
            $("#messages").append('<li>' +" " + message['talker'] + ': ' + message['time'] + '  ' + message['message'] + '</li>');
            talker = message['talker'];
            console.log('Received the message');
        })

        $('#sendButton').on('click', function () {
            socket.send($('#myMessage').val());
            $('#myMessage').val('');
        })

        $('#room').on('click', function(){
            socket.emit('join', {'room': $('#roomName').val()});
            $('room').text('Leave Room');
        })

        $('#historyButton').on('click', function(){
            socket.emit('check history', $('#roomName').val());
        })

    })
</script>

<ul id="messages"></ul>


<input type="text" id="myMessage">
<button id="sendButton">Send</button>
<input type="text" id="roomName">

<!-- <input type="text" id="roomName"> -->
<button id="room">Join Room</button>

{% endblock content %}